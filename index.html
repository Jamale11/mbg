<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ID Card Generator</title>
<style>
    body {
        font-family: Arial;
        background: #eef1f5;
        padding: 20px;
        text-align: center;
    }

    .container {
        background: white;
        padding: 20px;
        border-radius: 12px;
        width: 420px;
        margin: auto;
        box-shadow: 0 4px 10px rgba(0,0,0,0.15);
    }

    canvas {
        width: 100%;
        border-radius: 12px;
        border: 1px solid #ccc;
        margin-top: 15px;
    }

    input {
        width: 100%;
        padding: 10px;
        margin-top: 10px;
        border-radius: 8px;
        border: 1px solid #aaa;
    }

    button {
        margin-top: 15px;
        padding: 12px 20px;
        border: none;
        background: #007bff;
        color: white;
        font-weight: bold;
        border-radius: 8px;
        cursor: pointer;
    }

    button:hover {
        background: #005fcc;
    }
</style>
</head>
<body>

<div class="container">
    <h2>ID CARD GENERATOR</h2>

    <input type="file" id="photoUpload" accept="image/*">
    <input type="text" id="name" placeholder="Nama">
    <input type="text" id="idnum" placeholder="Nomor ID">

    <button id="downloadBtn">Download ID Card</button>

    <canvas id="card" width="600" height="380"></canvas>
</div>

<script>
let uploadedPhoto = null;
let bgLogo = new Image();
bgLogo.src = "logo_sppg.png"; // gunakan logo kamu

document.getElementById("photoUpload").addEventListener("change", function(e){
    const file = e.target.files[0];
    if(!file) return;

    const reader = new FileReader();
    reader.onload = function(evt){
        const img = new Image();
        img.onload = function(){
            uploadedPhoto = img;
            renderCard();
        };
        img.src = evt.target.result;
    };
    reader.readAsDataURL(file);
});

function renderCard(){
    const name = document.getElementById("name").value;
    const idnum = document.getElementById("idnum").value;

    const c = document.getElementById("card");
    const ctx = c.getContext("2d");

    ctx.clearRect(0,0,c.width,c.height);

    // ==== BACKGROUND LOGO (Full Card) ====
    if(bgLogo.complete){
        ctx.save();
        ctx.globalAlpha = 0.18;  // supaya soft
        ctx.drawImage(bgLogo, 0, 0, c.width, c.height);
        ctx.restore();
    }

    // ==== FOTO USER ====
    if(uploadedPhoto){
        ctx.save();
        ctx.beginPath();
        ctx.roundRect(30, 80, 150, 200, 20);
        ctx.clip();
        ctx.drawImage(uploadedPhoto, 30, 80, 150, 200);
        ctx.restore();
    }

    // ==== TEXT ====
    ctx.fillStyle = "#000";
    ctx.font = "bold 28px Arial";
    ctx.fillText("SPPG BERINGIN", 220, 60);

    ctx.font = "22px Arial";
    ctx.fillText("Nama : " + name, 220, 140);
    ctx.fillText("ID     : " + idnum, 220, 180);

    ctx.font = "18px Arial";
    ctx.fillText("PANGENAN", 220, 230);
}

setInterval(renderCard, 200);

// ==== DOWNLOAD PNG ====
document.getElementById("downloadBtn").addEventListener("click", function(){
    const c = document.getElementById("card");
    const link = document.createElement("a");
    link.download = "ID_CARD_SPPG.png";
    link.href = c.toDataURL("image/png");
    link.click();
});
</script>
</body>
</html>
